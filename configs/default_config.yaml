# MMI PBS 默认配置

# 结构参数
structure:
  n_cells_x: 120  # 6.0um / 0.05um = 120
  n_cells_y: 48   # 2.4um / 0.05um = 48 (偶数网格确保 y=0 和 y=width/4=0.6 对齐到网格边界)
  init_mode: "random"

# 几何参数 (单位: μm)
geometry:
  wavelength: 1.55
  mmi_width: 2.4    # 调整宽度以对齐网格: 2.4/4 = 0.6um (整除0.1和1/30)
  mmi_length: 6.0   # 增加长度
  wg_width: 0.5
  wg_length: 1.0    # 缩短直波导
  taper_length: 1.0 # 锥形波导长度
  taper_width: 1.0  # 锥形波导在设计区域端的宽度
  thickness: 0.22

# 材料参数
materials:
  n_si: 3.48
  n_sio2: 1.44

# 仿真参数 (精度优先)
simulation:
  resolution: 30   # 提高分辨率: 20 -> 30 (50nm -> 33nm grid) 以提高梯度精度
  run_time: 200
  pml_thickness: 1.0

# 并行参数
parallel:
  num_workers: 12  # 并行工作进程数

# 奖励函数参数
reward:
  alpha: 1.0   # TE→Port1 权重
  beta: 1.0    # TM→Port2 权重
  gamma: 0.5   # 串扰惩罚权重
  type: "absolute"  # absolute 或 delta

# 训练参数
training:
  max_episode_steps: 500
  total_timesteps: 100000
  learning_rate: 0.0003
  batch_size: 64
  n_epochs: 10
  gamma: 0.99
  entropy_coeff: 0.01
  clip_range: 0.2

# 伴随法超级动作 (方案3)
rl:
  adjoint_cost: 0.5
  flip_cost: 0.01
  adjoint_steps: 5
  adjoint_lr: 0.01
  adjoint_target_weights:
    te_port1: 1.0
    tm_port2: 1.0

# 日志路径
logging:
  log_dir: "./results/rl_adjoint_results"
